<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>py-opc</title>
  

  <link rel="shortcut icon" href="./img/favicon.ico">

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="./css/theme.css" type="text/css" />
  <link rel="stylesheet" href="./css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="./css/highlight.css">

  
  <script>
    // Current page data
    var mkdocs_page_name = "None";
  </script>
  
  <script src="./js/jquery-2.1.1.min.js"></script>
  <script src="./js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="./js/highlight.pack.js"></script>
  <script src="./js/theme.js"></script> 

  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="." class="icon icon-home"> py-opc</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="./search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li>
    <li class="toctree-l1 current">
        <a class="current" href=".">py-opc</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#py-opc">py-opc</a></li>
                
                    <li><a class="toctree-l4" href="#requirements">Requirements</a></li>
                
                    <li><a class="toctree-l4" href="#installation">Installation</a></li>
                
                    <li><a class="toctree-l4" href="#using-the-module">Using the Module</a></li>
                
                    <li><a class="toctree-l4" href="#handling-exceptions">Handling Exceptions</a></li>
                
                    <li><a class="toctree-l4" href="#getting-help">Getting Help</a></li>
                
            
            </ul>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="examples/">Examples</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="api/">API</a>
        
    </li>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href=".">py-opc</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".">Docs</a> &raquo;</li>
    
      
    
    <li>py-opc</li>
    <li class="wy-breadcrumbs-aside">
      
        
          <a href="https://github.com/dhhagan/py-opc/" class="icon icon-github"> Edit on GitHub</a>
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="py-opc">py-opc</h1>
<p>py-opc is a python library for interacting with the Alphasense OPC-N2 through
the Serial Peripheral Interface (SPI) bus. The objective is to make it easy to run
the OPC-N2 from a Raspberry Pi. The library is designed to run on a Raspberry Pi 2, with Python 3.x.</p>
<p>Versions are incremented according to <a href="http://semver.org/">semver</a></p>
<p>Current OPC firmware versions that are supported include:</p>
<ul>
<li>v14</li>
<li>v15</li>
<li>v17</li>
</ul>
<p>Other firmware versions may work, but have not yet been tested. If you would like to test the library on a different firmware version and report back, it would be greatly appreciated.</p>
<h2 id="requirements">Requirements</h2>
<ul>
<li><a href="https://github.com/doceme/py-spidev">py-spidev</a></li>
</ul>
<h2 id="installation">Installation</h2>
<h3 id="git">Git</h3>
<pre><code>&gt;&gt;&gt; git clone https://github.com/dhhagan/py-opc.git
&gt;&gt;&gt; sudo python3 setup.py install
</code></pre>
<h3 id="zip">Zip</h3>
<pre><code>&gt;&gt;&gt; wget https://github.com/dhhagan/py-opc/archive/master.zip
&gt;&gt;&gt; unzip master.zip
&gt;&gt;&gt; cd py-opc/
&gt;&gt;&gt; sudo python3 setup.py install
</code></pre>
<h3 id="testing-your-installation">Testing your installation</h3>
<p>Testing is completed using the unittesting python module. Once the Raspberry Pi is connected to the OPC and the opc library is installed, you can run unittests as follows:</p>
<pre><code>&gt;&gt;&gt; python3 -m unittest discover tests/
</code></pre>
<h2 id="using-the-module">Using the Module</h2>
<p>Check out the <a href="">quickstart manual</a> for an easy to use example!</p>
<h3 id="setting-up-the-raspberry-pi">Setting up the Raspberry Pi</h3>
<p>If you are not familiar with setting up a Raspberry Pi to be used with a SPI device, a couple of great tutorials can be found <a href="https://www.raspberrypi.org/documentation/hardware/raspberrypi/spi/">here</a>, <a href="https://projects.drogon.net/understanding-spi-on-the-raspberry-pi/">here</a>, and <a href="http://www.brianhensley.net/2012/07/getting-spi-working-on-raspberry-pi.html">here</a>. A few important things to note:</p>
<ol>
<li>The Alphasense OPC-N2 is a 3v3 logic SPI mode 1 device</li>
<li>The OPC requires up to 250 mA, so powering through the Raspberry Pi is not an option</li>
</ol>
<p>To connect the Raspberry Pi to the OPC-N2, there are a total of four connections that need to be made, plus ground and power. The power source must be 5V, and should power both the Raspberry Pi and the OPC. The connections that need to be made are layed out below.</p>
<table>
<thead>
<tr>
<th>Pin</th>
<th>Function</th>
<th>OPC-N2</th>
<th>Raspberry Pi</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>Ground</td>
<td>GND</td>
<td>-</td>
</tr>
<tr>
<td>2</td>
<td>Chip Select</td>
<td>/SS</td>
<td>CE0 or CE1</td>
</tr>
<tr>
<td>3</td>
<td>Master Out Slave In</td>
<td>SDI</td>
<td>MOSI</td>
</tr>
<tr>
<td>4</td>
<td>Clock</td>
<td>SCK</td>
<td>CLK</td>
</tr>
<tr>
<td>5</td>
<td>Master In Slave Out</td>
<td>SDO</td>
<td>MISO</td>
</tr>
<tr>
<td>6</td>
<td>Power</td>
<td>Vcc</td>
<td>-</td>
</tr>
</tbody>
</table>
<p>Some day there may even be some nice looking diagrams, but I don't have an Illustrator license as of now (booo Adobe!).</p>
<h2 id="handling-exceptions">Handling Exceptions</h2>
<p>If the SPI connection you feed to the <strong>OPCN2</strong> class is not an instance of the <strong>spidev.SpiDev</strong> class, the <strong>py-opc</strong>
library will throw an <strong>SPIError</strong>. Likewise, if the firmware cannot be determined when initiating the <strong>OPCN2</strong> class, a <strong>FirmwareError</strong> will be raised. Both exceptions can be handled gracefully as follows:</p>
<pre><code>import opc
import spidev

spi = spidev.SpiDev()
spi.open(0, 0)
spi.mode = 1

try:
  alpha = OPCN2(spi)
except Exception as e:
  print ("OPC Exception: {0}".format(e))
</code></pre>
<h2 id="getting-help">Getting Help</h2>
<p>Still running into problems?</p>
<ul>
<li>To report a problem with this documentation, <a href="mailto:david@davidhhagan.com">contact the author</a>.</li>
<li><a href="https://github.com/dhhagan/py-opc/issues/new">Report an issue</a> with the py-opc library on Github</li>
<li><a href="https://github.com/dhhagan/py-opc/issues/new">Submit a feature request</a> for py-opc on Github</li>
</ul>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="examples/" class="btn btn-neutral float-right" title="Examples"/>Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a class="icon icon-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
      
        <span style="margin-left: 15px"><a href="examples/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>

</body>
</html>

<!--
MkDocs version : 0.14.0
Build Date UTC : 2015-06-10 17:39:53.558169
-->
